---
description: 新しい記事トピックを提案し、評価スコアとともに優先順位付けして表示します
argument-hint: [カテゴリ（省略可）]
---

新しい記事トピックの提案を生成します。

## 入力パラメータ

ユーザーが指定可能なパラメータ：

- **カテゴリ** (省略可): 特定カテゴリに絞って提案
  - `unsolved`: 未解決事件
  - `urban`: 都市伝説・怪談
  - `unidentified`: 不思議現象・UFO
  - `history`: 歴史の謎・オカルト
  - 省略時: 全カテゴリから提案

## 処理フロー

### Phase 1: 既存記事の確認

1. **articles フォルダのスキャン**

   `ls articles/` で既存の記事フォルダを確認し、
   すでに執筆済みのトピックをリスト化します。

   ```bash
   ls -d articles/*/ 2>/dev/null | grep -v ".gitkeep" || echo "既存記事なし"
   ```

2. **記事 ID とメタデータの取得**

   各記事フォルダから article-meta.json を読み込み、
   トピック名とカテゴリを抽出します。

   ```bash
   for dir in articles/*/; do
     if [ -f "$dir/article-meta.json" ]; then
       cat "$dir/article-meta.json" | jq -r '.title'
     fi
   done
   ```

### Phase 2: トピック提案の生成

1. **topic-suggester エージェントの起動**

   Task ツールを使用して topic-suggester エージェントを実行します。

   入力情報：
   - カテゴリフィルター（指定された場合）
   - 既存記事リスト（重複回避用）

   ```
   Task(
     subagent_type="topic-suggester",
     description="記事トピック提案",
     prompt="カテゴリ: {category}, 既存記事: {existing_articles}"
   )
   ```

2. **提案結果の取得**

   エージェントから JSON 形式の提案リストを受け取ります。

### Phase 3: 結果の整形と表示

1. **スコア順でソート**

   合計スコアの高い順に提案をソートします。

2. **見やすい形式で出力**

   ```markdown
   # 📝 新規記事トピック提案

   ## 🎯 カテゴリ: {指定カテゴリまたは全カテゴリ}

   ### 🏆 TOP 5 推薦トピック

   1. **{タイトル}** (スコア: {total}/50)
      - カテゴリ: {category}
      - 概要: {description}
      - 評価:
        - 読者関心度: ⭐×{score}
        - 情報入手性: ⭐×{score}
        - 執筆実現性: ⭐×{score}
        - 独自性: ⭐×{score}
        - エンタメ性: ⭐×{score}
      - 推薦理由: {recommendation}

   ### 📋 その他の候補

   6. {タイトル} (スコア: {total}/50)
   7. {タイトル} (スコア: {total}/50)
   ...
   ```

### Phase 4: 次のアクション提案

1. **記事作成コマンドの提示**

   選択されたトピックで記事を作成する場合のコマンドを表示：

   ```
   記事を作成する場合:
   /new-article {選択したトピック名}
   ```

2. **追加情報の提供**

   - 各カテゴリの記事数バランス
   - 未開拓のサブジャンル
   - 季節性・時事性のあるトピック

## 実行例

```bash
# 全カテゴリから提案
/suggest-topics

# 未解決事件カテゴリに絞って提案
/suggest-topics unsolved

# 都市伝説カテゴリに絞って提案
/suggest-topics urban
```

## エラーハンドリング

1. **無効なカテゴリ指定**

   指定されたカテゴリが存在しない場合：
   ```
   ⚠️ 無効なカテゴリです。以下から選択してください：
   - unsolved (未解決事件)
   - urban (都市伝説・怪談)
   - unidentified (不思議現象・UFO)
   - history (歴史の謎・オカルト)

   全カテゴリから提案を生成します...
   ```

2. **エージェント実行エラー**

   topic-suggester エージェントの実行に失敗した場合：
   ```
   ❌ トピック提案の生成に失敗しました
   手動で以下の候補から選択してください：
   [事前定義された基本候補リスト]
   ```

## 出力ファイル（オプション）

生成された提案を保存する場合：

```bash
# 提案結果を JSON ファイルとして保存
echo "$suggestions" > data/topic-suggestions-$(date +%Y%m%d).json

# Markdown レポートとして保存
echo "$report" > docs/topic-suggestions-$(date +%Y%m%d).md
```

## 評価基準の詳細

### reader_interest（読者関心度）1-10
- 10: 誰もが知っている有名な謎
- 8-9: 一般的に知られている事件
- 6-7: マニアには有名な事件
- 4-5: あまり知られていない事件
- 1-3: ほとんど知られていない事件

### information_availability（情報入手性）1-10
- 10: Wikipedia、書籍、論文多数
- 8-9: 複数の信頼できる情報源
- 6-7: 情報源は限定的だが信頼できる
- 4-5: 情報源が少ない
- 1-3: ほとんど情報がない

### feasibility（執筆実現性）1-10
- 10: 構成しやすく適度な分量
- 8-9: 多少の工夫で執筆可能
- 6-7: 執筆には工夫が必要
- 4-5: 執筆が困難
- 1-3: 現実的に執筆不可能

### uniqueness（独自性）1-10
- 10: 完全にオリジナルな切り口
- 8-9: 新しい視点を提供可能
- 6-7: ある程度の差別化可能
- 4-5: 既存コンテンツと重複多
- 1-3: 完全に既出の内容

### entertainment_value（エンタメ性）1-10
- 10: 極めて魅力的なミステリー
- 8-9: 十分な謎と驚きがある
- 6-7: それなりに面白い
- 4-5: やや退屈
- 1-3: エンタメ性に欠ける

## 成功基準

- [ ] 10 個以上のトピック提案生成
- [ ] スコアリングの妥当性確認
- [ ] 既存記事との重複回避確認
- [ ] 見やすい出力フォーマット
- [ ] エラーハンドリング動作確認

## 関連コマンド

- `/new-article` - 選択したトピックで新規記事作成
- `/research` - 作成した記事のリサーチ実行
- `/wiki-search` - 特定トピックの Wikipedia 情報収集
