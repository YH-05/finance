# スキル設計ガイド

## スキル設計原則

### 1. ナレッジベースの原則

スキルは**知識・手順・テンプレート**を提供し、実際の処理は既存ツールを活用します。

**スキルの役割**:
- ガイドライン提供: 何をどうすべきかの知識
- テンプレート提供: 標準的な出力形式
- 手順提供: ステップバイステップのプロセス

**実処理の委譲先**:
- MCP サーバー: ファイルシステム、Git 操作
- gh CLI: GitHub Issue/PR/Project 操作
- 組み込みツール: Read, Write, Edit, Glob, Grep

**良い例**:
```yaml
スキルが提供するもの:
  - ベースルールや知識、手順など
  - コーディング規約（どう書くべきか）
  - テストパターン（どうテストすべきか）
  - レビュー基準（何を確認すべきか）
  - ドメイン知識（業界用語、考え方、慣習）

スキルが提供しないもの:
  - ファイルの読み書き（→ Read/Write ツール）
  - Git 操作（→ MCP サーバー / Bash）
  - GitHub API 呼び出し（→ gh CLI）
```

### 2. 単一責任の原則（Single Responsibility）

各スキルは**1つの明確なドメイン**に特化すべきです。

**良い例**:
- `coding-standards`: Python コーディング規約
- `tdd-development`: TDD 開発プロセス
- `error-handling`: エラーハンドリングパターン

**悪い例**:
- `general-knowledge`: あらゆる知識を含む
- `everything-guide`: 何でもガイドしようとする
- `code-and-docs`: コードとドキュメントの両方を担当

### 3. 構造の一貫性

全スキルは以下の標準構造に従います：

```
.claude/skills/{skill-name}/
├── SKILL.md           # エントリーポイント（必須）
├── guide.md           # 詳細ガイド（オプション）
├── template.md        # 出力テンプレート（オプション）
├── examples/          # 使用例・パターン集（オプション）
└── scripts/           # スキル実行時に使用するプログラム（オプション）
```

**各ファイルの役割**:

| ファイル        | 役割                      | 読み込みタイミング |
| ----------- | ----------------------- | --------- |
| SKILL.md    | エントリーポイント、概要、クイックリファレンス | 常にプリロード   |
| guide.md    | 詳細なガイドライン、設計原則          | 必要時に Read |
| template.md | 出力テンプレート、フォーマット         | 必要時に Read |
| examples/   | 具体的な使用例、パターン集           | 必要時に Read |
| scripts/    | スキル実行時に使用するプログラム        | 必要時に Read |
|             |                         |           |

### 4. プリロード最適化

スキルはエージェントのコンテキストにプリロードされるため、**簡潔さ**が重要です。

**コンテキスト効率化の指針**:

```yaml
SKILL.md（常にロード）:
  - 目的: 1-2段落
  - いつ使用するか: 箇条書きで簡潔に
  - プロセス: 主要ステップのみ
  - 品質基準: チェックリスト形式

guide.md（必要時のみ）:
  - 詳細な設計原則
  - 深い説明と背景
  - トラブルシューティング

template.md（必要時のみ）:
  - 完全なテンプレート
  - 記入例
  - バリエーション
```

### 5. 検証可能性（Testability）

スキルの適用結果を**検証可能**に設計します。

- 明確な品質基準（MUST/SHOULD）
- チェックリスト形式の完了条件
- 成功/失敗の判定基準

## スキル構造の詳細

### SKILL.md の構造

```markdown
---
name: skill-name              # kebab-case、ディレクトリ名と一致
description: |                # Skill tool に表示される説明
  Short description for when to use this skill.
  Include trigger keywords.
allowed-tools: Read, Write    # 使用可能なツール（オプション）
---

# Skill Name

[1-2文での概要説明]

## 目的

このスキルは以下を提供します：

- [提供価値1]
- [提供価値2]

## いつ使用するか

### プロアクティブ使用
- [自動的に検討すべきシナリオ]

### 明示的な使用
- [ユーザーが要求する場合]

## プロセス

### 1. [ステップ名]
[ステップの説明]

### 2. [ステップ名]
[ステップの説明]

## リソース

### ./guide.md
[ガイドの内容説明]

### ./template.md
[テンプレートの内容説明]

## 使用例

### 例1: [シナリオ名]
**状況**: [背景]
**処理**: [手順]
**結果**: [期待される出力]

## 品質基準

### 必須（MUST）
- [ ] [必須基準1]

### 推奨（SHOULD）
- [推奨基準1]

## 完了条件

- [ ] [完了条件1]
- [ ] [完了条件2]
```

### guide.md の構造

guide.md は SKILL.md を補完する**詳細ガイド**です。

```markdown
# [スキル名] 設計ガイド

## [スキルドメイン] 設計原則

### 1. [原則名]
[詳細な説明]

### 2. [原則名]
[詳細な説明]

## [カテゴリ/分類] の説明

### [カテゴリ1]
[詳細な説明]

## プロンプトエンジニアリング

### [セクション設計]
[詳細なガイドライン]

## 品質保証基準

### チェックリスト
- [ ] [確認項目]

## トラブルシューティング

### [問題パターン]
**原因**: [原因説明]
**対処法**: [解決方法]

## ベストプラクティス

### DO（推奨）
1. [推奨事項]

### DON'T（避けるべき）
1. [避けるべきこと]
```

### template.md の構造

template.md は**出力テンプレート**を提供します。

```markdown
# [スキル名] テンプレート

## 標準テンプレート

---
[フロントマター]
---

# [セクション構造]

[テンプレート内容]

## バリエーション

### [バリエーション1]
[バリエーション内容]

## 記入例

### 完全な例
[実際の記入例]
```

## プロンプトエンジニアリング

### フロントマター設計

```yaml
---
name: skill-name              # 必須: kebab-case
description: |                # 必須: Skill tool 表示用
  Description with trigger keywords.
  Use PROACTIVELY when [condition].
allowed-tools: Read, Write    # オプション: ツール制限
---
```

**name フィールド**:
- kebab-case を使用
- ディレクトリ名と一致
- 簡潔で説明的

**description フィールド**:
- 1-3文で簡潔に
- トリガーキーワードを含める
- 「いつ使うか」を明確に
- プロアクティブ使用の条件を含める

**良い description の例**:
```yaml
# 良い例
description: |
  Create and optimize Claude Code skills. Expertise in skill design,
  SKILL.md structuring, guide/template creation. Use PROACTIVELY
  when designing new skills or improving existing ones.

# 悪い例
description: スキルを管理する
```

### セクション設計

#### 1. 導入部（Identity）

```markdown
# [スキル名]

[スキルが何を提供するかの簡潔な説明]

## 目的

このスキルは以下を提供します：

- **[機能1]**: [具体的な説明]
- **[機能2]**: [具体的な説明]
```

**ポイント**:
- スキルの役割を明確に定義
- 提供する価値を具体的に列挙
- 「何をするか」と「何をしないか」を明確に

#### 2. When to Use（使用タイミング）

```markdown
## いつ使用するか

### プロアクティブ使用（自動で使用を検討）

以下の状況では、ユーザーが明示的に要求しなくても使用を検討：

1. **[シナリオカテゴリ1]**
   - [具体的なトリガー1]
   - [具体的なトリガー2]

2. **[シナリオカテゴリ2]**
   - [具体的なトリガー1]

### 明示的な使用（ユーザー要求）

- `/skill-name` コマンド
- 「〜を作って」「〜を改善して」などの直接的な要求
```

**ポイント**:
- プロアクティブ使用のトリガーを明確に
- 具体的なキーワードやフレーズを列挙
- 境界条件を明示

#### 3. Process（処理フロー）

```markdown
## プロセス

### 1. [ステップ名]

[ステップの目的と概要]

```bash
# コマンド例
command here
```

**チェックポイント**:
- [ ] [検証項目1]
- [ ] [検証項目2]

### 2. [次のステップ]
...
```

**ポイント**:
- 明確なステップバイステップガイド
- 各ステップの目的と期待される結果
- 検証可能なチェックポイント
- 具体的なコマンド/コード例

#### 4. Examples（実例）

```markdown
## 使用例

### 例1: [シナリオ名]

**状況**: [背景と条件]

**処理**:
1. [ステップ1]
2. [ステップ2]

**期待される出力**:
```
[具体的な出力例]
```

**補足**: [注意点や追加情報]
```

**ポイント**:
- 3-4個の現実的なユースケース
- 具体的な入力/出力例
- コンテキストと背景情報
- エッジケースや注意点

#### 5. Quality Criteria（品質基準）

```markdown
## 品質基準

### 必須（MUST）

- [ ] [絶対に満たすべき基準1]
- [ ] [絶対に満たすべき基準2]

### 推奨（SHOULD）

- [推奨される基準1]
- [推奨される基準2]
```

**ポイント**:
- MUST: 満たさなければ失敗
- SHOULD: 満たすことが望ましい
- チェックリスト形式で検証可能に

## スキルフロントマター検証ルール

### 検証対象フィールド

| フィールド | 必須 | 形式 | 説明 |
|-----------|------|------|------|
| name | ✅ | kebab-case | ディレクトリ名と一致 |
| description | ✅ | 文字列 | Skill tool 表示用 |
| allowed-tools | ❌ | カンマ区切り | 使用可能なツール |

### name フィールドの検証

```yaml
検証ルール:
  - kebab-case であること（小文字、ハイフン区切り）
  - ディレクトリ名と完全一致
  - 2-50文字
  - 英数字とハイフンのみ

OK例:
  - skill-expert
  - coding-standards
  - tdd-development

NG例:
  - SkillExpert      # PascalCase
  - skill_expert     # snake_case
  - SKILL-EXPERT     # 大文字
  - skill expert     # スペース
```

### description フィールドの検証

```yaml
検証ルール:
  - 空でないこと
  - 10-500文字
  - トリガーキーワードを含む
  - 具体的な目的を説明

推奨パターン:
  - "Use PROACTIVELY when [condition]" を含む
  - 動詞で始まる（Create, Optimize, Analyze）
  - 専門領域を明示

OK例:
  - "Create and optimize Claude Code skills. Use PROACTIVELY when designing new skills."

NG例:
  - "スキル管理"        # 曖昧すぎる
  - ""                 # 空
```

### allowed-tools フィールドの検証

```yaml
有効なツール一覧:
  - Read
  - Write
  - Edit
  - Glob
  - Grep
  - Bash
  - WebFetch
  - WebSearch
  - AskUserQuestion
  - Task
  - TodoWrite
  - Skill

検証ルール:
  - 有効なツール名のみ
  - カンマ区切り
  - 重複なし

OK例:
  - "Read, Write, Glob"
  - "Read, Write, AskUserQuestion, Task"

NG例:
  - "Read, Write, InvalidTool"   # 無効なツール
  - "Read Write Glob"            # カンマなし
```

### 検証チェックリスト

スキル作成後に以下を確認：

```markdown
## フロントマター検証

- [ ] name がディレクトリ名と一致
- [ ] name が kebab-case
- [ ] description が空でない
- [ ] description がトリガーキーワードを含む
- [ ] allowed-tools（設定時）が有効なツールのみ

## 構造検証

- [ ] SKILL.md が存在
- [ ] 必須セクションが含まれている（目的、いつ使用するか、プロセス）
- [ ] 使用例が3つ以上
- [ ] 品質基準が定義されている
- [ ] 完了条件が明確

## リソース検証（設定時）

- [ ] guide.md が存在し、SKILL.md で参照されている
- [ ] template.md が存在し、SKILL.md で参照されている
- [ ] examples/ が存在し、SKILL.md で参照されている
```

## スキルカテゴリ分類

### repository-management（リポジトリ管理）

リポジトリ構造、ドキュメント、プロジェクト管理に関するスキル。

**例**:
- `glossary-creation`: 用語集の作成
- `repository-structure`: リポジトリ構造定義
- `project-file`: プロジェクトファイル管理

### coding（コーディング）

コード品質、開発プロセス、エラーハンドリングに関するスキル。

**例**:
- `development-guidelines`: 開発ガイドライン
- `functional-design`: 機能設計書作成
- `architecture-design`: アーキテクチャ設計

### meta（メタスキル）

スキル・エージェント・ワークフロー自体の設計に関するスキル。

**例**:
- `skill-expert`: スキル設計・管理（このスキル）
- `agent-expert`: エージェント設計・管理
- `workflow-expert`: ワークフロー設計・管理

### domain-specific（ドメイン固有）

特定のドメインに特化したスキル。

**例**:
- `finance-news-workflow`: 金融ニュース収集ワークフロー
- `prd-writing`: PRD（要求定義書）作成
- `deep-research`: ディープリサーチ

## 品質保証基準

### スキルチェックリスト

作成したスキルが以下を満たすか確認：

#### 構造

- [ ] フロントマターが正しく設定されている
- [ ] name がディレクトリ名と一致（kebab-case）
- [ ] description が具体的でトリガーキーワードを含む
- [ ] allowed-tools（設定時）が最小限

#### 内容

- [ ] スキルの目的が明確
- [ ] 使用タイミングが具体的
- [ ] プロセスがステップバイステップ
- [ ] 3-4個の実用的な例がある
- [ ] 品質基準が明確（MUST/SHOULD）

#### 実用性

- [ ] 実際に使用可能なシナリオ
- [ ] 具体的な入力/出力例
- [ ] エラーケースへの対処
- [ ] 完了条件が検証可能

#### ドキュメント

- [ ] 明確で理解しやすい説明
- [ ] 実践的な例とコード
- [ ] トラブルシューティング情報

## トラブルシューティング

### スキルが参照されない

**原因**:
1. description にトリガーキーワードがない
2. skills: フィールドでの参照漏れ
3. Skill tool での呼び出しミス

**対処法**:
- description を見直し、明確なトリガーワードを追加
- 関連エージェントの skills: フィールドを確認
- `/skill-name` コマンドで直接呼び出しを試す

### リソースファイルが見つからない

**原因**:
1. guide.md/template.md が存在しない
2. パスの指定ミス
3. SKILL.md での参照漏れ

**対処法**:
- リソースファイルの存在を確認
- SKILL.md での参照パスを修正（`./guide.md` 形式）
- ファイル名のスペルを確認

### フロントマター検証エラー

**原因**:
1. YAML 構文エラー
2. 必須フィールドの欠落
3. 無効な値

**対処法**:
- YAML 構文を修正（インデント、クォート）
- 必須フィールド（name, description）を追加
- allowed-tools を有効なツール名に修正

### スキルの内容が反映されない

**原因**:
1. SKILL.md の構造が不適切
2. セクションの配置ミス
3. マークダウン構文エラー

**対処法**:
- 標準的なスキル構造に従う
- ヘッダーレベルを確認（## で主要セクション）
- マークダウンプレビューで確認

### プリロードでコンテキストが溢れる

**原因**:
1. SKILL.md が長すぎる
2. 詳細情報を SKILL.md に含めすぎ
3. 冗長な説明

**対処法**:
- SKILL.md を簡潔に（概要のみ）
- 詳細は guide.md に移動
- 箇条書きで要点を絞る

## ベストプラクティス

### DO（推奨）

1. **ナレッジに徹する**
   - スキルは「知識」を提供
   - 実処理は既存ツールに委譲
   - Python スクリプトは最小限に

2. **簡潔さを優先**
   - SKILL.md は概要のみ
   - 詳細は guide.md に
   - 箇条書きを活用

3. **具体的な例を含める**
   - 実際の使用シナリオを示す
   - 入力と出力の例を提供
   - エッジケースを含める

4. **検証可能な基準**
   - チェックリスト形式
   - MUST/SHOULD の区別
   - 客観的に判定可能

5. **プロアクティブ使用を明示**
   - description に条件を含める
   - 「いつ使用するか」を具体的に
   - トリガーキーワードを列挙

### DON'T（避けるべき）

1. **曖昧な説明**
   - 「適切に処理する」
   - 「必要に応じて対応」
   - 具体性のない指示

2. **過度な実装**
   - スキル内での Python スクリプト実行
   - 複雑な自動化ロジック
   - ツールの機能と重複

3. **責任範囲の曖昧さ**
   - 「何でもできる」スキル
   - 重複する責任
   - 不明確な境界

4. **コンテキストの肥大化**
   - SKILL.md に全情報を詰め込む
   - 冗長な説明
   - 不要な例の列挙

5. **検証不可能な基準**
   - 主観的な成功基準
   - 曖昧な完了条件
   - 測定できない品質基準

## スキル設計パターン

### 1. ガイドラインスキル

ルール・規約・ベストプラクティスを提供するスキル。

**特徴**:
- 明確なルール（MUST/SHOULD/NEVER）
- 具体的な例（良い例/悪い例）
- チェックリスト

**例**: `coding-standards`, `development-guidelines`

### 2. プロセススキル

ステップバイステップの手順を提供するスキル。

**特徴**:
- 順序立てた手順
- 各ステップの検証ポイント
- 完了条件

**例**: `tdd-development`, `project-file`

### 3. テンプレートスキル

出力フォーマットやテンプレートを提供するスキル。

**特徴**:
- 標準テンプレート
- バリエーション
- 記入例

**例**: `prd-writing`, `architecture-design`

### 4. メタスキル

スキル・エージェント・ワークフロー自体を設計するスキル。

**特徴**:
- 設計原則
- 構造定義
- 品質基準

**例**: `skill-expert`, `agent-expert`, `workflow-expert`

## まとめ

優れたスキル設計の鍵：

1. **ナレッジに徹する**: 知識・手順・テンプレートを提供、実処理はツールに委譲
2. **単一責任**: 1つの明確なドメインに特化
3. **簡潔さ**: SKILL.md は概要、詳細は guide.md に
4. **検証可能性**: チェックリスト形式の品質基準
5. **プロアクティブ**: 使用タイミングを明確に、トリガーキーワードを含める

これらの原則に従って、ユーザーにとって価値のあるスキルを設計してください。
